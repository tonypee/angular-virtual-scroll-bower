/* angular-virtual-scroll - v0.5.0 - 2013-12-17 */ (function(){"use strict";angular.module("sf.virtualScroll",[])})(),function(){"use strict";var t=angular.module("sf.virtualScroll");t.filter("sublist",function(){return function(t,e,r){return t.slice(r,r+e)}})}(),function(){"use strict";var t=angular.module("sf.virtualScroll");t.directive("sfScroller",function(){function t(t){var e=t.match(/^(x|y)\s*(=|in)\s*(.+) to (.+)$/);if(!e)throw Error("Expected sfScroller in form of '_axis_ in _lower_ to _upper_' but got '"+t+"'.");return{axis:e[1],lower:e[3],upper:e[4]}}var e=18;return function(r,i,o){var n=t(o.sfScroller),l=r.$eval(n.lower),a=r.$eval(n.upper),c="x"===n.axis;i.css({height:c?"1em":"100%",width:c?"100%":"1em","overflow-x":c?"scroll":"hidden","overflow-y":c?"hidden":"scroll",position:"absolute",top:c?"100%":0,right:0}).parent().css({position:"relative"});var s=angular.element("<div></div>");i.append(s),i.bind("scroll",function(){var t=i.prop("scrollTop");o.ngModel&&r.$apply(o.ngModel+" = "+t/e)}),r.$watch(n.lower,function(t){l=t,s.css("height",(a-l)*e+"px")}),r.$watch(n.upper,function(t){a=t,s.css("height",(a-l)*e+"px")}),r.$watch(o.ngModel,function(t){var r=t*e;i.prop("scrollTop")!==r&&i.prop("scrollTop".scrollTop)})}})}(),function(){"use strict";function t(e,r,i){return angular.isArray(e)?angular.forEach(e,function(e){return t(e,r,i)}):Math.max(r,Math.min(e,i))}var e=angular.module("sf.virtualScroll"),r=["TABLE","TBODY","THEAD","TR","TFOOT"],i=["TABLE","TBODY","THEAD","TR","TFOOT"],o=["TABLE","TBODY","THEAD","TR","TFOOT"];e.directive("sfVirtualRepeat",["$log","$rootElement",function(e,n){function l(t){var e=t.match(/^\s*([\$\w]+)\s+in\s+([\S\s]*)$/);if(!e)throw Error("Expected sfVirtualRepeat in form of '_item_ in _collection_' but got '"+t+"'.");return{value:e[1],collection:e[2]}}function a(t,e){var r,i=t.tagName.toUpperCase();for(r=0;e.length>r;r++)if(e[r]===i)return!0;return!1}function c(t){var e,o,l=n[0];for(e=t.parent().parent()[0];e!==l&&1==e.nodeType;e=e.parentNode)if(!a(e,r)&&1==e.childElementCount&&!a(e.firstElementChild,i)){for(o=e.firstChild;o&&(3!=o.nodeType||!/\S/g.test(o.textContent));o=o.nextSibling);if(null==o)return{viewport:angular.element(e),content:angular.element(e.firstElementChild)}}throw Error("No suitable viewport element")}function s(t){var e={overflow:"auto"},r=window.getComputedStyle?window.getComputedStyle(t[0]):t[0].currentStyle,i=r&&r.getPropertyValue("max-height"),o=r&&r.getPropertyValue("height");i&&"0px"!==i?e.maxHeight=i:e.height=o&&"0px"!==o?o:window.innerHeight,t.css(e)}function u(t){var e={margin:0,padding:0,border:0,"box-sizing":"border-box"};t.css(e)}function f(t){var e=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r=e&&e.getPropertyValue("max-height"),i=e&&e.getPropertyValue("height");if(i&&"0px"!==i&&"auto"!==i);else if(r&&"0px"!==r&&"none"!==r)i=r;else{if(!t.clientHeight)throw Error("Unable to compute height of row");i=t.clientHeight+"px"}return angular.element(t).css("height",i),parseInt(i,10)}function p(e,r,i){function n(e,r,n){function l(t){var e={margin:"0"};a(t[0],o)||(e.display="block"),$&&(e.height=$+"px"),t.css(e)}function h(t,e,r){var i=r.$new(),o=r.$eval(e);return i[p.value]=o[t],i.$index=t,i.$first=0===t,i.$last=t===o.length-1,i.$middle=!(i.$first||i.$last),i.$watch(function(){o=r.$eval(e),i[p.value]=o[t]}),i}function g(t,e,r,o,n){var a,c,s,u=document.createDocumentFragment(),f=[];for(c=t;c!==e;c++)s=h(c,r,o),a=i(s,angular.noop),l(a),f.push(a),u.appendChild(a[0]);return n.after(u),f}function v(){var e=t(E.firstActive,E.firstVisible-E.lowWater,E.firstVisible-E.highWater),r=t(E.firstActive+E.active,E.firstVisible+E.visible+E.lowWater,E.firstVisible+E.visible+E.highWater);E.firstActive=t(e,0,E.total-E.visible-E.lowWater),E.active=Math.min(r,E.total)-E.firstActive}function d(t){$&&e.$apply(function(){E.firstVisible=Math.floor(t.target.scrollTop/$),E.visible=Math.ceil(y.viewport[0].clientHeight/$),b=t.target.scrollTop+t.target.clientHeight>=t.target.scrollHeight,v()})}function w(t){var e=t.$eval(p.collection);return e.length!==E.total&&(E.total=e.length,v()),{start:E.firstActive,active:E.active,len:e.length}}function m(t,e){var r,i,o=Array.prototype[t];for(i=0;e>i;i++)r=o.call(T),r.scope().$destroy(),r.remove()}function x(t,e,i){var o,n=e.start+e.active;if(t===e)o=g(t.start,n,p.collection,i,r),T=o,T.length&&($=f(o[0][0]));else{var l=t.start+t.active,a=t.start>=e.start,c=a?t.start-e.start:e.start-t.start,s=l>=n?l-n:n-l,u=(a?e.active:t.active)>c;if(u){if(a?m("shift",c):c&&(o=g(t.start,e.start,p.collection,i,r),T=o.concat(T)),n>l)m("pop",n-l);else if(s){var h=T[T.length-1];o=g(n,l,p.collection,i,h),T=T.concat(o)}}else m("pop",T.length),T=g(t.start,l,p.collection,i,r);!$&&T.length&&($=f(T[0][0])),y.content.css({"padding-top":t.start*$+"px"})}y.content.css({height:t.len*$+"px"}),b&&(y.viewport[0].scrollTop=y.viewport[0].clientHeight+y.viewport[0].scrollHeight)}var T=[],$=0,b=!1,y=c(r),E="ngModel"in n?e.$eval(n.ngModel):{};E.firstActive=0,E.firstVisible=0,E.visible=0,E.active=0,E.total=0,E.lowWater=E.lowWater||100,E.highWater=E.highWater||300,u(y.content),s(y.viewport),y.viewport.bind("scroll",d),e.$watch(w,x,!0)}var p=l(r.sfVirtualRepeat);return{post:n}}return{require:"?ngModel",transclude:"element",priority:1e3,terminal:!0,compile:p}}])}();